<nb-card>
  <nb-card-header>User Dashboard</nb-card-header>
  <nb-card-body>
    <h3>Hello, {{ email }}</h3>
    <p class="muted">Hereâ€™s a quick view of your alarms and recent activity.</p>
  </nb-card-body>
</nb-card>

<div class="grid">
  <nb-card *ngFor="let s of summary" class="stat">
    <nb-card-header>
      <nb-icon [icon]="s.icon"></nb-icon> {{ s.label }}
    </nb-card-header>
    <nb-card-body><h2>{{ s.value }}</h2></nb-card-body>
  </nb-card>
  
  <nb-card class="span-2">
    <nb-card-header>Recent Activity</nb-card-header>
    <nb-card-body>
      <ul class="recent">
        <li *ngFor="let r of recent">
          <span class="time">{{ r.time }}</span>
          <span class="text">{{ r.text }}</span>
        </li>
      </ul>
    </nb-card-body>
  </nb-card>
</div>

<!-- Live (son 10 dk) -->
<nb-card>
  <nb-card-header>Live (last 10 min)</nb-card-header>
  <nb-card-body>
    <div class="flex" style="gap:12px; align-items:center; margin-bottom:8px;">
      <strong>Active:</strong> <span class="badge">{{ (totalActive$ | async) ?? 0 }}</span>
    </div>
    <table class="table" *ngIf="(recent$ | async) as recent; else empty">
      <thead>
        <tr><th>Time</th><th>Location</th><th>Level</th><th>Message</th></tr>
      </thead>
      <tbody>
        <tr *ngFor="let e of recent | slice:0:5">
          <td>{{ e.timestamp | date:'shortTime' }}</td>
          <td>{{ e.location }}</td>
          <td>{{ e.level }}</td>
          <td>{{ e.message }}</td>
        </tr>
      </tbody>
    </table>
    <ng-template #empty><em>No live events.</em></ng-template>
  </nb-card-body>
</nb-card>